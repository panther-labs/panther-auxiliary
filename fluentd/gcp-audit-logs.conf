<system>
  log_level debug
</system>

<source>
  @type gcloud_pubsub
  tag gcp.audit
  project <YOUR-GCP-PROJECT-ID>
  key <PATH-TO-YOUR-KEYPAIR>
  topic <PANTHER-AUDIT-TOPIC-ID>
  subscription <PANTHER-AUDIT-SUBSCRIPTION-ID>
  max_messages 1000
  return_immediately true
  pull_interval 1
  pull_threads 2
  parse_error_action exception
  enable_rpc true
  rpc_bind 0.0.0.0
  rpc_port 24680
  <parse>
    @type json
  </parse>
</source>

<match gcp.**>
  @type kinesis_firehose
  region <YOUR-FIREHOSE-REGION>
  delivery_stream_name <YOUR-FIREHOSE-NAME>

  <assume_role_credentials>
    duration_seconds 3600
    role_arn <YOUR-FIREHOSE-ROLE-ARN>
    role_session_name "#{Socket.gethostname}-panther-audit"
  </assume_role_credentials>
</match>
